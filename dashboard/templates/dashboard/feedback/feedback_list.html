<!DOCTYPE html>
{% load static %}
<html>
<head>
    <meta charset="utf-8">
    <title>Artwork Feedback</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'dashboard/css/styles.css' %}">
</head>
<body>
<div class="grid-container">

    {% include "dashboard/partials/header.html" %}
    {% include "dashboard/partials/sidebar.html" %}

    <main class="main-container">
       <div class="main-title" style="display:flex;flex-wrap:wrap;align-items:flex-start;gap:10px;">
    <div style="margin-right:auto;">
        <h2 style="margin:0;">FEEDBACK</h2>
        <p style="font-size:14px;color:#777;margin-top:4px;">
            Approve or remove visitor comments on artworks.
        </p>
    </div>

    <a href="{% url 'dashboard_feedback_export' %}"
       style="padding:8px 12px;background:#27ae60;color:#fff;border-radius:4px;
              font-size:13px;text-decoration:none;display:inline-block;align-self:flex-start;">
        â¬‡ Export Excel
    </a>
</div>


        <div class="charts-card" style="overflow-x:auto;">
            <table style="width:100%; border-collapse:collapse; font-size:14px;">
                <thead>
                    <tr style="border-bottom:2px solid #ddd;text-align:left;">
                        <th style="padding:10px;">Artwork</th>
                        <th style="padding:10px;">By</th>
                        <th style="padding:10px;">Rating</th>
                        <th style="padding:10px;">Approved?</th>
                        <th style="padding:10px;">Comment</th>
                        <th style="padding:10px;">Created</th>
                        <th style="padding:10px;">Actions</th>
                    </tr>
                </thead>
                <tbody>
                {% for fb in feedbacks %}
                    <tr style="border-bottom:1px solid #eee;">
                        <td style="padding:10px;">{{ fb.artwork.title }}</td>

                        <td style="padding:10px;">
                            {% if fb.user %}
                                {{ fb.user.username }}
                            {% elif fb.name %}
                                {{ fb.name }}
                            {% else %}
                                Anonymous
                            {% endif %}
                        </td>

                        <td style="padding:10px;">{{ fb.rating }}/5</td>

                        <td style="padding:10px;">
                            {% if fb.is_approved %}
                                <span style="color:green;font-weight:600;">YES</span>
                            {% else %}
                                <span style="color:#999;">Pending</span>
                            {% endif %}
                        </td>

                        <td style="padding:10px; max-width:250px; white-space:normal; word-break:break-word;">
                            {{ fb.comment|truncatechars:120 }}
                        </td>

                        <td style="padding:10px;">{{ fb.created_at }}</td>

                        <td style="padding:10px;white-space:nowrap;">
                            <a href="{% url 'dashboard_feedback_edit' fb.id %}"
                               style="padding:6px 10px;background:#3498db;color:#fff;border-radius:4px;font-size:12px;">Review</a>

                            <form method="post"
                                  action="{% url 'dashboard_feedback_delete' fb.id %}"
                                  style="display:inline;">
                                {% csrf_token %}
                                <button type="submit"
                                        onclick="return confirm('Delete this feedback?');"
                                        style="padding:6px 10px;background:#e74c3c;color:#fff;border:none;border-radius:4px;font-size:12px;cursor:pointer;">
                                    Delete
                                </button>
                            </form>
                        </td>
                    </tr>
                {% empty %}
                    <tr>
                        <td colspan="7" style="padding:20px;color:#666;text-align:center;">
                            No feedback yet.
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </main>

</div>
<script src="{% static 'dashboard/js/scripts.js' %}"></script>
</body>
</html>
