<!DOCTYPE html>
{% load static %}
<html>
<head>
    <meta charset="utf-8">
    <title>Artworks</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'dashboard/css/styles.css' %}">
    <style>
      .filter-card {
        background:#fff;
        border-radius:8px;
        box-shadow:0 2px 8px rgba(0,0,0,.05);
        padding:16px;
        margin-bottom:20px;
        font-size:14px;
      }
      .filter-row {
        display:flex;
        flex-wrap:wrap;
        gap:12px;
      }
      .filter-group {
        display:flex;
        flex-direction:column;
        min-width:140px;
      }
      .filter-group label {
        font-size:12px;
        font-weight:600;
        color:#555;
        margin-bottom:4px;
        text-transform:uppercase;
        letter-spacing:.03em;
      }
      .filter-group input,
      .filter-group select {
        padding:8px 10px;
        border:1px solid #ccc;
        border-radius:4px;
        font-size:13px;
      }
      .filter-actions {
        display:flex;
        align-items:flex-end;
        gap:8px;
      }
      .btn-primary {
        background:#3498db;
        color:#fff;
        border:none;
        padding:9px 14px;
        border-radius:4px;
        cursor:pointer;
        font-size:13px;
        font-weight:600;
        text-decoration:none;
        display:inline-block;
      }
      .btn-secondary {
        background:#eee;
        color:#333;
        border:none;
        padding:9px 14px;
        border-radius:4px;
        cursor:pointer;
        font-size:13px;
        font-weight:600;
        text-decoration:none;
        display:inline-block;
      }
      @media(max-width:700px){
        .filter-row { flex-direction:column; }
        .filter-actions { align-items:stretch; flex-direction:column; }
        .filter-actions .btn-primary,
        .filter-actions .btn-secondary { width:100%; text-align:center; }
      }
    </style>
</head>
<body>
<div class="grid-container">

    {% include "dashboard/partials/header.html" %}
    {% include "dashboard/partials/sidebar.html" %}

    <main class="main-container">
        <div class="main-title" style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px;">
            <h2>ARTWORKS</h2>
            <a href="{% url 'dashboard_artwork_create' %}"
               style="color:#fff; background:#2ecc71;padding:8px 12px;border-radius:4px;font-size:13px;font-weight:600;text-decoration:none;">
               + Add Artwork
            </a>
        </div>

        <!-- FILTER / SEARCH BAR -->
        <form method="get" class="filter-card">
          <div class="filter-row">

            <div class="filter-group" style="flex:1 1 180px;">
              <label for="q">Search</label>
              <input type="text" id="q" name="q"
                     placeholder="title / artist / description / year..."
                     value="{{ filter_q }}">
            </div>

            <div class="filter-group">
              <label for="visible">Visible?</label>
              <select id="visible" name="visible">
                <option value="" {% if not filter_visible %}selected{% endif %}>Any</option>
                <option value="yes" {% if filter_visible == "yes" %}selected{% endif %}>YES</option>
                <option value="no"  {% if filter_visible == "no" %}selected{% endif %}>Hidden</option>
              </select>
            </div>

            <div class="filter-group">
              <label for="year_from">Year (match)</label>
              <input type="text" id="year_from" name="year_from"
                     placeholder="e.g. 1889"
                     value="{{ filter_year_from }}">
            </div>

            <div class="filter-group">
              <label for="year_to">Year (2nd match)</label>
              <input type="text" id="year_to" name="year_to"
                     placeholder="e.g. 1890"
                     value="{{ filter_year_to }}">
            </div>

            <div class="filter-group">
              <label for="created_from">Created After</label>
              <input type="date" id="created_from" name="created_from"
                     value="{{ filter_created_from }}">
            </div>

            <div class="filter-group">
              <label for="created_to">Created Before</label>
              <input type="date" id="created_to" name="created_to"
                     value="{{ filter_created_to }}">
            </div>

            <div class="filter-actions">
              <button type="submit" class="btn-primary">Apply</button>

              <a href="{% url 'dashboard_artwork_list' %}" class="btn-secondary">
                Clear
              </a>
            </div>

          </div>
        </form>

        <div class="charts-card" style="overflow-x:auto;">
            <table style="width:100%; border-collapse:collapse; font-size:14px;">
                <thead>
                    <tr style="border-bottom:2px solid #ddd;text-align:left;">
                        <th style="padding:10px;">Image</th>
                        <th style="padding:10px;">Title</th>
                        <th style="padding:10px;">Artist</th>
                        <th style="padding:10px;">Year</th>
                        <th style="padding:10px;">Visible?</th>
                        <th style="padding:10px;">Created</th>
                        <th style="padding:10px;">Actions</th>
                    </tr>
                </thead>
                <tbody>
                {% for art in artworks %}
                    <tr style="border-bottom:1px solid #eee; vertical-align:top;">
                        <td style="padding:10px;">
                            {% if art.image %}
                                <img src="{{ art.image.url }}"
                                     alt="{{ art.title }}"
                                     style="width:60px;height:60px;object-fit:cover;border-radius:4px;border:1px solid #ddd;">
                            {% else %}
                                <div style="width:60px;height:60px;border-radius:4px;border:1px solid #ddd;background:#f5f5f5;color:#999;display:flex;align-items:center;justify-content:center;font-size:11px;text-align:center;line-height:1.2;">
                                    no image
                                </div>
                            {% endif %}
                        </td>

                        <td style="padding:10px;font-weight:600;">{{ art.title }}</td>
                        <td style="padding:10px;">{{ art.artist|default:"—" }}</td>
                        <td style="padding:10px;">{{ art.year|default:"—" }}</td>

                        <td style="padding:10px;">
                            {% if art.is_visible %}
                                <span style="color:green;font-weight:600;">YES</span>
                            {% else %}
                                <span style="color:#999;">Hidden</span>
                            {% endif %}
                        </td>

                        <td style="padding:10px;">
                            {{ art.created_at|date:"Y-m-d" }}<br>
                            <span style="color:#777;font-size:12px;">
                                {{ art.created_at|date:"H:i" }}
                            </span>
                        </td>

                        <td style="padding:10px;white-space:nowrap;">
                            <a href="{% url 'dashboard_artwork_edit' art.id %}"
                               style="padding:6px 10px;background:#3498db;color:#fff;border-radius:4px;font-size:12px;text-decoration:none;">Edit</a>

                            <form method="post"
                                  action="{% url 'dashboard_artwork_delete' art.id %}"
                                  style="display:inline;">
                                {% csrf_token %}
                                <button type="submit"
                                        onclick="return confirm('Delete artwork {{ art.title }} ?');"
                                        style="padding:6px 10px;background:#e74c3c;color:#fff;border:none;border-radius:4px;font-size:12px;cursor:pointer;">
                                    Delete
                                </button>
                            </form>
                        </td>
                    </tr>
                {% empty %}
                    <tr>
                        <td colspan="7" style="padding:20px;color:#666;text-align:center;">
                            No artworks found.
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>

        {% if page_obj.paginator.num_pages > 1 %}
          <p style="margin:10px 0 0; font-size:13px; color:#666; text-align:center;">
            Showing {{ page_obj.start_index }}–{{ page_obj.end_index }} of {{ page_obj.paginator.count }} artworks
          </p>

          <div style="padding:16px; font-size:13px; display:flex; gap:8px; flex-wrap:wrap; justify-content:center;">

            {% if page_obj.has_previous %}
              <a class="btn-secondary"
                 href="?page={{ page_obj.previous_page_number }}&q={{ filter_q }}&visible={{ filter_visible }}&year_from={{ filter_year_from }}&year_to={{ filter_year_to }}&created_from={{ filter_created_from }}&created_to={{ filter_created_to }}">
                ‹ Prev
              </a>
            {% endif %}

            <span style="padding:9px 14px;border:1px solid #ddd;border-radius:4px;">
              Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}
            </span>

            {% if page_obj.has_next %}
              <a class="btn-secondary"
                 href="?page={{ page_obj.next_page_number }}&q={{ filter_q }}&visible={{ filter_visible }}&year_from={{ filter_year_from }}&year_to={{ filter_year_to }}&created_from={{ filter_created_from }}&created_to={{ filter_created_to }}">
                Next ›
              </a>
            {% endif %}
          </div>
        {% endif %}

    </main>
</div>

<script src="{% static 'dashboard/js/scripts.js' %}"></script>
</body>
</html>
